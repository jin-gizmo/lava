#- docker job specifics
#-
#- This is the list of vars to prompt for when building
#= payload: Image Repo (exclude prefix provided by lava job framework)
#= command: Command to run in the container (leave empty to use container default)

type: docker

## #############################################################################
## The payload is the container repository and, optionally, tag in the form
## repository[:tag]. If the tag is not specified, a tag of latest is used.
##
payload: "<{ lava.aws.ecr_uri }>/<{ prefix.docker_repo }>/{{ payload }}"

## #############################################################################
## Job parameters

parameters:
  ## ---------------------------------------------------------------------------
  ## Mandatory params

  ## ---------------------------------------------------------------------------
  ## Optional params

  ## - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - -
  ## The command to run in the container. If not specified, the default entry
  ## point for the container is used.
  # command: "{{ command }}"

  ## - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - -
  ## The conn_id for connecting to docker. If not specified, a value must be
  ## specified for the entire realm in the realms table.
  # docker: conn_id_for_docker_registry

  ## - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - -
  ## A list of additional arguments for the executable(s) specified in payload.
  # args:
  #   - "arg1"
  #   - "arg2"

  ## - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - -
  ## Keys are connection labels and the values are conn_id.
  # connections:
  #     conn1: "conn1_id"
  #     conn2: "conn2_id"

  ## - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - -
  ## A map of additional environment variables for the exe.
  ##
  # env:
  #   env_var1: "value1"
  #   env_var2: "value2"

  ## - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - -
  ## Enable / disable jinja rendering. Default is true. If false, disable Jinja
  ## rendering of the args. Default true.
  ##
  # jinja: true

  ## - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - -
  ## Job timeout. Default is 10 minutes. Values are in the form nnX where nn is
  ## a number and X is s (seconds), m (minutes) or h (hours). If payload is a
  ## list, this is applied to each individual exe.
  ##
  # timeout: "10m"

  ## - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - -
  ## A map of variables injected when the command arguments and environment are
  ## Jinja rendered.
  ##
  # vars:
  #   var1: "value1"
  #   var2: "value2"

  ## - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - -
  # A map of container host configuration parameters.
  # host_config:
  #   blkio_weight: ??
  #   blkio_weight_device: ??
  #   cap_add: ??
  #   cap_drop: ??
  #   cpu_count: ??
  #   cpu_percent: ??
  #   cpu_period: ??
  #   cpu_quota: ??
  #   cpu_shares: ??
  #   cpuset_cpus: ??
  #   cpuset_mems: ??
  #   device_read_bps: ??
  #   device_read_iops: ??
  #   device_write_bps: ??
  #   device_write_iops: ??
  #   dns: ??
  #   dns_opt: ??
  #   dns_search: ??
  #   domainname: ??
  #   extra_hosts: ??
  #   group_add: ??
  #   mem_limit: ??
  #   mem_swappiness: ??
  #   memswap_limit: ??
  #   nano_cpus: ??
  #   network_disabled: ??
  #   network_mode: ??
  #   ports: ??
  #   publish_all_ports: ??
  #   shm_size: ??
  #   user: ??
  #   working_dir: ??
